{% load static %}

<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>AI ê°€ì‚¬ ìƒì„±ê¸°</title>
    <style>
        body {
            background-color: #000;  /* ë°°ê²½ì„ ì–´ë‘¡ê²Œ */
            }
        
        input, select, button {
            color: white;
            background-color: #222;
            border: 1px solid #555;
            padding: 5px;
            margin: 5px;
        }

        .modal {
          position: fixed;
          top: 10%;
          left: 50%;
          transform: translateX(-50%);
          width: 500px;
          max-height: 80vh;
          overflow-y: auto;
          padding: 20px;
          background: white;
          border: 1px solid #999;
          box-shadow: 0 0 20px rgba(0,0,0,0.3);
          z-index: 1000;
          opacity: 0;
          transition: opacity 0.3s ease;
        }
      
        .modal.show {
          opacity: 1;
        }
      
        #modalBackdrop {
          position: fixed;
          top: 0; left: 0;
          width: 100%; height: 100%;
          background: rgba(0,0,0,0.4);
          z-index: 999;
          display: none;
        }
        .logo-box {
        position: fixed;
        top: 30px;
        left: 30px;
        z-index: 1000;
        display: flex;
        align-items: center;
        }

        .logo-box a {
        color: #fff;
        text-decoration: none;
        display: flex;
        align-items: center;
        }

        #logo-image {
        height: 40px;
        }

        #logo-text {
        font-size: 1.8rem;
        margin-left: 10px;
        color: white;
        }

        .nav-icon {
        position: fixed;
        top: 30px;
        right: 50px;
        z-index: 1000;
        cursor: pointer;
        }

        .nav-icon span {
        display: block;
        height: 4px;
        background: white;
        margin: 6px 0;
        width: 25px;
        }

        .side-menu {
        position: fixed;
        right: -50%;
        top: 0;
        width: 50%;
        height: 100%;
        background: #000;
        color: white;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: right 0.5s ease;
        z-index: 999;
        }

        .wrapper.nav-open .side-menu {
        right: 0;
        }

        .side-menu ul {
        list-style: none;
        text-align: right;
        }

        .side-menu li {
        font-size: 2rem;
        padding: 20px 0;
        cursor: pointer;
        }

        .side-menu li:hover {
        color: #60a5fa;
        }
      </style>
      
</head>
<body>
    <div class="wrapper">
        <!-- âœ… ë¡œê³  -->
        <div class="logo-box" id="logoBox">
          <a href="#">
            <img id="logo-image" src="{% static 'apple.png' %}">
            <span id="logo-text">MUSICTASTE</span>
          </a>
        </div>
    
        <!-- âœ… í–„ë²„ê±° ë©”ë‰´ ì•„ì´ì½˜ -->
        <div class="nav-icon" id="navIcon">
          <span></span>
          <span></span>
          <span></span>
        </div>
    
        <!-- âœ… ì‚¬ì´ë“œ ë©”ë‰´ -->
        <nav class="side-menu">
          <ul>
            <li data-target="section1">Home</li>
            <li data-target="section2">Works</li>
            <li data-target="section3">About</li>
            <li data-target="section4">Contact</li>
            <li data-target="section5">Hire us</li>
          </ul>
        </nav>

        <h1 style="margin-top: 100px; text-align: center; color: white;">AI ë®¤ì¦ˆ</h1>

    <!-- ì…ë ¥ í¼ -->
    <form method="POST" action="{% url 'generate_lyrics' %}" style="margin-top: 100px;">
        {% csrf_token %}
        <input type="text" name="prompt" placeholder="ë…¸ë˜ ì£¼ì œ ì…ë ¥" required style="width:300px; padding:5px;">

        <!-- ğŸ¼ ìŠ¤íƒ€ì¼ ì„ íƒ -->
        <select name="style" required>
            <option value="ballad">ë°œë¼ë“œ</option>
            <option value="hip-hop">í™í•©</option>
            <option value="rock">ë¡</option>
            <option value="pop">íŒ</option>
            <option value="indie">ì¸ë””</option> 
            <option value="jazz">ì¬ì¦ˆ</option>
        </select>

        <select name="language" required>
            <option value="none">ìƒê´€ì—†ìŒ</option>
            <option value="korean">í•œêµ­ì–´</option>       <!-- Korean -->
            <option value="english">English</option>     <!-- English -->
            <option value="japanese">æ—¥æœ¬èª</option>      <!-- Japanese -->
            <option value="chinese">ä¸­æ–‡</option>         <!-- Chinese -->
            <option value="thai">à¹„à¸—à¸¢</option>            <!-- Thai -->
        </select>
        

        <button type="submit">ê°€ì‚¬ ìƒì„±</button>
    </form>

    {% if lyrics %}
<hr>

<!-- ì¢Œìš° ì •ë ¬ ì»¨í…Œì´ë„ˆ -->
<div style="display: flex; gap: 40px; align-items: flex-start;">

    <!-- ğŸ¤ ì™¼ìª½: ê°€ì‚¬ ì¶œë ¥ -->
    <div style="flex: 1;">
        <h2 style="color: white;">ğŸ¤ "{{ title }}"</h2>
        <p style="color: white;"><strong>ì£¼ì œ:</strong> {{ prompt }} / <strong>ìŠ¤íƒ€ì¼:</strong> {{ style }} / <strong>ì–¸ì–´:</strong> {{ language }}</p>
        <pre style="background:#f0f0f0; padding:10px;">{{ lyrics }}</pre>
    </div>


    <!-- ğŸ¨ ì˜¤ë¥¸ìª½: ì•¨ë²” ì´ë¯¸ì§€ + ë‹¤ìš´ë¡œë“œ -->
    <div style="flex: 1; text-align: center;">
        <h3 style="color: white;">ğŸ¨ ì•¨ë²” ì´ë¯¸ì§€</h3>
        <img src="{{ new_lyrics.image_file.url }}" width="256" style="border-radius: 8px;"><br>
        <a href="{{ new_lyrics.image_file.url }}" download style="color:rgb(110, 110, 223);" style="color: white;">ğŸ“¥ ì´ë¯¸ì§€ ë‹¤ìš´ë¡œë“œ</a>
        <p style="color: white;">â± ìƒì„± ì‹œê°„: {{ elapsed_time }}ì´ˆ</p>
    </div>

</div>
{% endif %}

{% if all_lyrics %}
    <hr>
    <h2>ğŸ—‚ ì´ì „ì— ë§Œë“  ê°€ì‚¬ë“¤</h2>
    <div style="display: flex; flex-wrap: wrap; gap: 20px;">
        {% for item in all_lyrics %}
            <div onclick="showLyricsModal(`{{ item.prompt }}`, `{{ item.lyrics|escapejs }}`)"
                 style="width: 200px; border: 1px solid #ccc; border-radius: 10px; padding: 10px; background: #fdfdfd;
                        box-shadow: 2px 2px 5px #ddd; cursor: pointer; text-align: center;">
    
                <!-- ì•¨ë²” ì¸ë„¤ì¼ -->
                <img src="{{ item.image_file.url }}" alt="ì•¨ë²” ì´ë¯¸ì§€" style="width: 100%; border-radius: 8px; margin-bottom: 8px;">
    
                <strong>{{ item.prompt }}</strong><br>
                <small>
                    {{ item.style }} /
                    {% if item.language == "korean" %}
                      ğŸ‡°ğŸ‡· í•œêµ­ì–´
                    {% elif item.language == "english" %}
                      ğŸ‡ºğŸ‡¸ ì˜ì–´
                    {% elif item.language == "japanese" %}
                      ğŸ‡¯ğŸ‡µ ì¼ë³¸ì–´
                    {% elif item.language == "chinese" %}
                      ğŸ‡¨ğŸ‡³ ì¤‘êµ­ì–´
                    {% elif item.language == "thai" %}
                      ğŸ‡¹ğŸ‡­ íƒœêµ­ì–´
                    {% else %}
                      ğŸŒ ì–¸ì–´ë¬´ê´€
                    {% endif %}
                  </small><br>
                  
                <small>{{ item.created_at|date:"Y-m-d H:i" }}</small>
            </div>
        {% endfor %}
    </div>
    
{% endif %}
<!-- ëª¨ë‹¬ì°½ -->
<!-- ëª¨ë‹¬ì°½ -->
<div id="lyricsModal" class="modal" style="display:none;">
    <h3 id="modalTitle">ğŸµ ì œëª©</h3>
    <pre id="modalLyrics" style="white-space: pre-wrap; background:#f9f9f9; padding:10px;"></pre>
    <button onclick="closeModal()">ë‹«ê¸°</button>
</div>

<!-- ë°°ê²½ ì–´ë‘¡ê²Œ -->
<div id="modalBackdrop" style="display:none;" onclick="closeModal()"></div>


<!-- ìë°”ìŠ¤í¬ë¦½íŠ¸ -->
<script>
    function showLyricsModal(title, lyrics) {
      const modal = document.getElementById("lyricsModal");
      const backdrop = document.getElementById("modalBackdrop");
  
      document.getElementById("modalTitle").innerText = `ğŸµ ${title}`;
      document.getElementById("modalLyrics").innerText = lyrics;
  
      backdrop.style.display = "block";
      modal.style.display = "block";
  
      // ì• ë‹ˆë©”ì´ì…˜ í´ë˜ìŠ¤ ë¶€ì—¬ (fade in)
      setTimeout(() => {
        modal.classList.add("show");
      }, 10);
    }
  
    function closeModal() {
      const modal = document.getElementById("lyricsModal");
      const backdrop = document.getElementById("modalBackdrop");
  
      modal.classList.remove("show"); // fade-out ì‹œì‘
      setTimeout(() => {
        modal.style.display = "none";
        backdrop.style.display = "none";
      }, 300); // ì• ë‹ˆë©”ì´ì…˜ ì‹œê°„ê³¼ ë§ì¶°ì•¼ í•¨ (0.3s)
    }
  
    // âŒ¨ï¸ ESC í‚¤ë¡œ ë‹«ê¸°
    document.addEventListener("keydown", function(e) {
      if (e.key === "Escape") {
        closeModal();
      }
    });


    const navIcon = document.getElementById('navIcon');
    const wrapper = document.querySelector('.wrapper');
    const menuLinks = document.querySelectorAll('.side-menu li');

    navIcon.addEventListener('click', () => {
        wrapper.classList.toggle('nav-open');
    });

    menuLinks.forEach(link => {
        link.addEventListener('click', () => {
        wrapper.classList.remove('nav-open');
        });
    });
</script>
  


</body>
</html>
