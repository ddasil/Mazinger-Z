{% extends 'base.html' %}
{% load static %}

{% block title %}{{ title }} ê°ì„± ë¶„ì„ ê²°ê³¼{% endblock %}

{% block extra_head %}
<link rel="stylesheet" href="{% static 'CSS/analyze_result.css' %}">
{% endblock %}

{% block content %}
<div class="lyrics-result-wrapper">
  <h1>ê°ì„± ë¶„ì„ ê²°ê³¼<br>"{{ title }}"</h1>

  {% if not user.is_authenticated %}
    <div class="login-notice">
      <p>ğŸ”’ ì´ ë¶„ì„ ê²°ê³¼ëŠ” ì €ì¥ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.
        <a href="{% url 'login' %}?next={{ request.path }}">ë¡œê·¸ì¸</a> í•˜ë©´ ë§ˆì´í˜ì´ì§€ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆì–´ìš”.
      </p>
    </div>
  {% else %}

  {% endif %}

<div class="analysis-section">
  <div class="emotion-list">
    <h2>ğŸ¯ ê°ì„± ì ìˆ˜ ğŸ¯</h2>
    <ul>
      {% for emotion, score in result.items %}
        <li class="emotion-row">
          <span class="label">{{ emotion }}</span>
          <span class="colon">:</span>
          <span class="score">{{ score|floatformat:2 }}%</span>
        </li>
      {% endfor %}
    </ul>
  </div>

  <div class="top3-box">
    <h3>ğŸ”¥ ìƒìœ„ ê°ì • TOP 3 ğŸ”¥</h3>
    <ul>
      {% for emotion, score in top3 %}
        <li class="emotion-row">
          <span class="label">ğŸ… {{ emotion }}</span>
          <span class="colon">:</span>
          <span class="score">{{ score|floatformat:2 }}%</span>
        </li>
      {% endfor %}
    </ul>
  </div>
</div>

  {% if warning %}
    <p class="warning">âš ï¸ {{ warning }}</p>
  {% endif %}

  <div class="button-group">
    {% for emotion, _ in top3 %}
      <a href="{% url 'recommend_by_emotion' emotion|cut:'#' %}?title={{ title }}&artist={{ artist }}" class="button recommend">
        ğŸ” {{ emotion }} ê°ì • ì¶”ì²œ ë³´ê¸°
      </a>
    {% endfor %}

    <a href="{% url 'analyze' %}" class="button retry">
      ğŸ” ë‹¤ë¥¸ ë…¸ë˜ ë¶„ì„í•˜ê¸°
    </a>
  </div>


  <div class="lyrics-section">
    <h2>ğŸ“ƒ ê°€ì‚¬</h2>
    <pre>{{ lyrics }}</pre>
  </div>
</div>
{% endblock %}

{% block extra_script %}
<script src="{% static 'js/base.js' %}"></script>
<script src="{% static 'JS/analyze_result.js' %}"></script>
{% endblock %}
